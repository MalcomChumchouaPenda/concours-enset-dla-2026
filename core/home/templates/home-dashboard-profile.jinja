{% extends 'dashboard/layout.jinja' %}
{% set page_id = 'profile_dash' %}


{% block page_header %}
  <h1>{{ _('Profil') }}</h1>
  <nav class="pb-3" aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="{{ url_for('home.dashboard') }}">{{ _('Accueil') }}</a></li>
      <li class="breadcrumb-item active" aria-current="page">{{ _('Profil') }}</li>
    </ol>
  </nav>
{% endblock %}



{% block page_main %}
<div class="container">
    <section class="section row g-4 pt-0">
    
        <!-- Alertes -->
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                        {{ message }}
                        <button aria-label="Close" class="btn-close" data-bs-dismiss="alert" type="button"></button>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith%}

        <!-- Actions initiales -->
        <div class="row m-1">
            <div class="col-lg-6 col-5"><span></span></div>
            <div class="col-lg-6 col-7">
                <a href="{{ url_for('home.change_password') }}" class="btn btn-primary btn-lg">{{ _('Changer mot de passe') }}</a>
            </div>
        </div><!-- End Actions initiales -->

        <form class="col-lg-8 col-12">

            <!-- Info generales -->
            <div class="card my-2">
                <div class="card-body p-3">
                    <div class="row mb-3">
                        <label for="id" class="col-lg-3 form-label col-10 py-lg-2 pt-2 pb-0 text-lg-end text-start">{{ _('Identifiant') }}</label>
                        <div class="col-lg-5 col-8">
                            <input type="text" class="form-control text-primary" disabled id="id"
                                   value="{{ current_user.id }}">
                        </div>
                    </div>
                    <div class="row mb-3">
                        <label for="nom" class="col-lg-3 form-label col-10 py-lg-2 pt-2 pb-0 text-lg-end text-start">{{ _('Noms') }}</label>
                        <div class="col-lg-8 col-12">
                            <input type="text" class="form-control" disabled id="nom" 
                                   value="{{ current_user.last_name }}">
                        </div>
                    </div>
                    <div class="row mb-3">
                        <label for="prenom" class="col-lg-3 form-label col-10 py-lg-2 pt-2 pb-0 text-lg-end text-start">{{ _('Prenoms') }}</label>
                        <div class="col-lg-8 col-12">
                            <input type="text" class="form-control" disabled id="prenom" 
                                   value="{{ current_user.first_name if current_user.first_name else '' }}">
                        </div>
                    </div>
                    <div class="row mb-3">
                        <label for="pwd" class="col-lg-3 form-label col-12 py-lg-2 pt-2 pb-0 text-lg-end text-start">{{ _('Mot de passe') }}</label>
                        <div class="col-lg-5 col-8">
                            <input type="text" class="form-control" disabled id="pwd" 
                                   value="{{ current_user.password_hash }}">
                        </div>
                        <div class="col-lg-4 col-4">
                            <a href="{{ url_for('home.change_password') }}" class="btn btn-primary btn-lg">{{ _('Changer') }}</a>
                        </div>
                    </div>
                    <div class="row mt-4 mb-3">
                        <label class="col-lg-3 form-label col-12 py-lg-2 pt-2 pb-0 text-lg-end text-start">{{ _('Roles') }}</label>
                        <div class="col-lg-8">
                            <textarea class="form-control" disabled rows="{{ current_user.roles | length }}">{{ 
                                current_user.roles | map(attribute="id")  | list | join('\n') 
                            }}</textarea>
                        </div>
                    </div>
                </div>
            </div>  <!-- End Info generales -->

        </form>

    </section>
</div>
{% endblock %}


{% block page_authors%} 
    <a>Malcom Chumchoua Penda</a>
{% endblock %}